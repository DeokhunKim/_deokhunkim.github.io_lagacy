---
layout: post
title: 위키 단어장 만들기 - 5.서비스 분리(MSA)
date: 2022-05-02
categories: [Spring, Glossary]
tags: [KPP]
author: Deokhun Kim
comment: false
update: 
---

### MSA
>MicroService Architecture

Monolithic Architecture 의 상반되는 말로, 각각의 서비스를 개별로 모듈화 시킨다는 개념의 아키텍쳐다.

이해하기 쉬운 인상적인 이미지가 있어서 가져왔다.

<img src="/assets/postimg/2022_05/msa.png">
*<\출처: https://wooaoe.tistory.com/57>*

<br/>

나는 애초에 해당 프로젝트 안에 개발을 시작하면서 분리 할 계획을 하고 있었다.
(처음부터 분리하여 개발하지 않고, 하나로 개발된 환경에서 분리작업을 해보며 공부하기 위해.)

그런데, 단어장 개발을 하며 MSA 의 필요성을 강제로 느끼게 됐다. 
바로 같은 프로젝트에 있던 **기존의 WebMessenger 가 먹통**이 되버린 것이다. 
원인은 단어장의 DB 를 구성하며 JPA 설정이 꼬였기 때문이었다. 
시작도 전에 "아 이래서 모듈화가 필요하구나.." 실감 하게 됐다.


<br/>

### 무엇을 고려해야 하지?
일단 제일 먼저 떠오르는 것은 **로그인 세션** 처리다. 
회원/비회원 에 따라 문서작성 권한의 차이가 있기 때문에 유저 정보를 가지고 와야한다. 

그 다음으로는 **서비스 방법** 이다. 
한 프로젝트로 할 때는 각각 필요한 controller 를 통해 유저 접속을 관리했지만, 
각각 서비스를 분리한다고 했을 때 어떻게 해야할지 전혀 감이 잡히지 않는다. 
_각 모듈에 controller 를 만들어야하나? 같은 포트를 사용하면 오류가 발생 안하나? 
각각 서비스를 하나씩 콘솔창으로 띄워야하나?_ 
지식이 없는 나는 머릿속에 전혀 그림이 그려지지 않는 상태이다.


이 부분들에 대해 먼저 사전 학습을 진행했다.

<br/>

### 사전 학습
#### JWT



<br/>

#### Spring Cloud Gateway


<br/>

#### Demo 어플리케이션 작성
https://velog.io/@zzarbttoo/SpringCloud-MSAAPI-Gateway-ServiceSpring-Cloud-Gateway



<br/>

### 청사진
<img src="/assets/postimg/2022_05/msa-split-1.svg">

<br/>

<img src="/assets/postimg/2022_05/msa-split-2.svg">

<br/>

<img src="/assets/postimg/2022_05/msa-split-3.svg">

<br/>

<img src="/assets/postimg/2022_05/msa-split-4.svg">

<br/>




<br/>
<br/>
<br/>
<br/>
<br/>

##### 참고 사이트
* https://wooaoe.tistory.com/57
* https://bbbicb.tistory.com/48
* 